name: todo_app infra workflow

on:
  push:
    branches:
      - 'main'

jobs:
  terraforminit:
    name: terraform initializationaca
    runs-on: windows-latest
    steps: 
    - name: Checkout to repo
      uses: actions/checkout@main
      
    - name: Azure Login
      uses: Azure/login@v2.3.0
      with:
        creds: ${{secrets.AZURE_CREDENTIALS}}
        
    - name: Install Terraform
      uses: little-core-labs/install-terraform@v2.0.0
      with:
        version: 1.13.0
        
    - name: Terraform init azurerm backend
      uses: ahmedig/terraform-azurerm-backend@v4
      with:
        azure_credentials: ${{secrets.AZURE_CREDENTIALS}}
        resource_group_name: Test
        container_name: teeraformtfstate
        storage_account_name: backendversioning
        file_name: versioning
        subscription_id: ${{fromJson(secrets.AZURE_CREDENTIALS).subscriptionId}}
              
        
    
        
       
